\documentclass[11pt]{article}

\usepackage[english]{babel}

\usepackage[letterpaper,top=3cm,bottom=3cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}

\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage[backend=bibtex, style=numeric, maxbibnames=9, sorting=none]{biblatex}
\addbibresource{sample.bib}
\usepackage{csquotes}
\usepackage{graphicx}
\usepackage[parfill]{parskip}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}
\usepackage{cleveref}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{definition}[theorem]{Definition}
\newtheorem{lemma}[theorem]{Lemma}
\renewcommand{\qedsymbol}{\ensuremath{\blacksquare}}

\begin{document}

\begin{titlepage}
  \begin{center}
    {\Large \textbf{Computing with real irreducible representations of finite groups}}

    \vspace{3cm}

    \includegraphics[width=64mm]{oxlogo.png}

    \vspace{3cm}

    %{\large
    %Pavol Koll√°r \par
    %Corpus Christi College \par
    %University of Oxford \par
    %\vspace{1cm}
    %Supervisor: Dr. Dmitrii Pasechnik
    %}
    {\large Candidate Number: XXXXXXX}

    \vspace{3cm}

    \emph{Final Honour School of Mathematics and Computer Science Part C} \par
    Trinity 2023 \par

  \end{center}
\end{titlepage}

\newpage

\section{Abstract}
Representation theory of finite groups over complex numbers is very well understood, in particular
it is classically known that all such representations of a group $G$ of exponent $n$ may be
realised over cyclotomic numbers of degree $n$. Real representations, i.e. these ones realised
by matrices with real entries, while important in applications, are understood much less.

It was open for a long time whether real representations of $G$ may be realised
over degree $n$ real cyclotomics; it was recently shown by Dmitrii Pasechnik to be
the case, cf. \cite{Pas21}.

The latter describes an algorithm to produce such a realisation. The main part of the
project will be to produce an implementation of this algorithm in one of computer
algebra system, most probably in GAP or in Sagemath.

The project can be viewed as a continuation of work carried out by Dmitrii Pasechnik
and his student Kaashif Hymabaccus in \cite{Hymabaccus2020}.

\textbf{Prerequisites}: some maths background, in particular in algebra, interest in open-source software.

\newpage

\tableofcontents

\newpage

\section{Introduction}

\#\#\# What should be here? Mentioned Brauer and the fact that we want to have real representations?
Or should I just purge this section completely? \#\#\#

\newpage

\section{Background}

The following section is dedicated to present the assumed background needed for this project.
Some notation is standard, other is not. Parts of linear algebra and group theory are assumed knowledge.

\subsection{Representation Theory}

For this subsection, let $G$ be a finite group, and let $V$ be a vector space.
The \textit{group of automorphisms} of $V$ is denoted $GL(V)$. For our purposes, we will only consider
cases where $V$ is a finite dimensional vector space over $\mathbb{R}$ or $\mathbb{C}$.
Given this, we shall associate $GL(V)$ with the appropriate invertible matrices over the canonical basis vectors.
\begin{definition}
  A \textbf{representation} of $G$ is a homomorphism $\rho: G \rightarrow GL(V)$.
\end{definition}
For example, here is a $2$-dimensional representation of $C_4 = \{e, x, x^2, x^3\}$:
\[\rho(e) = \begin{bmatrix}
  1 & 0 \\ 0 & 1
\end{bmatrix}, \rho(x) = \begin{bmatrix}
  0 & i \\ i & 0
\end{bmatrix}, \rho(x^2) = \begin{bmatrix}
  -1 & 0 \\ 0 & -1
\end{bmatrix}, \rho(x^3) = \begin{bmatrix}
  0 & -i \\ -i & 0
\end{bmatrix}\]
\begin{definition} \label{def:rep_iso}
  A representation $\rho: G \rightarrow GL(V)$ is \textbf{isomorphic} to $\sigma: G \rightarrow GL(W)$, when there exists a map $b: V \rightarrow W$,
  such that $b \circ \rho(g) = \sigma(g) \circ b$ for all $g \in G$ and for any vector.
\end{definition}
Viewing everything as matrices, we may interpret such $b$ as a change-of-basis matrix.
\begin{definition}
  Let $\rho: G \rightarrow GL(V)$ be a representation and let $U$ be a linear subspace of $V$.
  Then $U$ is \textbf{$G$-stable} if $\rho(g)(u) \in U$ for all $g \in G, u \in U$.
\end{definition}
From the previous definition stems an important follow-up definition of irreducibility, one of the
core notions of representation theory. In a sense, these irreducible representations are our building blocks.
\begin{definition}
  The representation $\rho: G \rightarrow GL(V)$ is called \textbf{irreducible} (sometimes \textbf{simple}) if
  $V$ is not the zero vector space, and if $U \leq V$ is $G$-stable, then $U = \{0\}$ or $U = V$.
\end{definition}
Lastly, we need the notion of a representation character. For our purposes, we restrict this definition to complex numbers.
\begin{definition}
  Let $\rho: G \rightarrow GL(V)$ be a complex representation of $G$. The character of $\rho$ is the function
  \[\chi_\rho: G \rightarrow \mathbb{C}, \chi_\rho(g) = \textnormal{tr} \rho(g).\]
\end{definition}
The important fact of representation theory is that, up to isomorphism, the character determines the representation.

\#\#\# More information about Kronecker products and symmetric squares? \#\#\#

\subsection{Field extensions}

Specifically, we will be using and talking about the extensions of rational numbers.
The most important one of which are the cyclotomic numbers. For a specific degree $n$ they are denoted $\mathbb{Q}(\zeta_n)$.
Here, $\zeta_n$ is a primitive $n^{\text{th}}$ root of unity, which means that the equation $x^n - 1 = 0$ has
precisely the (distinct and complex) roots $\zeta_n, \zeta_n^2, \ldots, \zeta_n^n = 1$. For our purposes, we
shall simply take $\zeta_n = e^{\frac{2\pi i}{n}}$.
\begin{definition}
  The \textbf{exponent} of $G$ is the smallest $n \in \mathbb{N}$, such that $\forall g \in G: g^n = 1_G$.
\end{definition}

These specific extensions are important to us, because of a result due to Brauer \#\#\# Isaacs CITATION (10.3) \#\#\#.
This result states that for any finite group $G$ with exponent $n$ and for any complex irreducible
character of this group, there is a complex representation that utilizes only the cyclotomic
numbers $\mathbb{Q}(\zeta_n)$ in the matrix entries.
We say that this representation is \textit{realised over} the $\mathbb{Q}(\zeta_n)$.

Furthermore, the group characters contain, among other things, information about whether the representation can
be realised over the real numbers.
\begin{definition}
  Let $\rho: G \rightarrow GL(V)$ be a complex representation of $G$. Let $\chi$ be the character
  of this representation. The \textbf{Frobenius-Schur indicator} is
  \[f = \frac{1}{\lvert G \rvert} \sum_{g \in G}\chi(g^2).\]
\end{definition}
If the representation is irreducible, then we call its character irreducible. Given that
the character is irreducible, we know that $f \in \{-1, 0, 1\}$. The case that is interesting to
us is when $f = 1$, since that means the representation \textit{can be} real valued (that is, it can map to
matrices whose entries are all real numbers). As Dr. Pasechnik proved in his paper \cite{Pas21} and we implemented in
this project, these representations can be realised over $\mathbb{R} \cap \mathbb{Q}(\zeta_n)$.

\subsection{GAP}

All programming in this project is done in the computer algebra system GAP \cite{GAP4}.
This system stores precise rational numbers, and thus can represent cyclotomic numbers in full generality.

Because we shall describe the code, sometimes instead of saying $\zeta_n$, we will say $\text{E}(n)$,
which is how GAP denotes the primitive roots. For example, $i = \text{E}(4)$ and $1 = E(6) + E(6)^5$.
Note that while $\zeta_4 = -i$ is a legitimate choice, it is non-standard and GAP defaults to the former.

\newpage

\section{Computing real representations}

\subsection{Algorithm of Dr. Pasechnik}

Let us begin by fixing some notation, following the notation in his paper \cite{Pas21}.

Let $G$ be a finite group, $n$ its exponent, $\chi$ one of its irreducible complex characters. 
Following the GAP naming, we shall say $\chi \in \text{Irr}(G)$. Further, let $\zeta_n = e^{\frac{2\pi i}{n}}, F=\mathbb{Q}(\zeta_n)$.
Brauer's theorem \#\#\# Isaacs CITATION (10.3) \#\#\# states that there is a
representation $\rho_\chi: G \rightarrow GL_d(F)$, which affords the irreducible character $\chi$.

Here, $d$ is a natural number, the so called degree of the representation.
It is a fact of representation theory that $d = \chi(1_G)$.
If this representation was real already, there would be nothing for us to prove. Therefore, we may
as well take $n \geq 3$, for otherwise, we already have a \textit{real} representation.

\begin{theorem}
  Let $E = \mathbb{Q}(\zeta_n) \cap \mathbb{R} = F \cap \mathbb{R} \subset F$.
  Also let $D = \mathbb{Q}(\zeta_n + \overline{\zeta_n})$.
  Then $E = D$, i.e. these two fields are identical.
\end{theorem}
\begin{proof}
  First of all, $D$ is a real field extension, since $\overline{\zeta_n + \overline{\zeta_n}} = \zeta_n + \overline{\zeta_n}$.
  Also, $D \subseteq F$, because any $d \in D$ is also in $F$, just having the same coefficients for $\zeta_n^i$ and $\overline{\zeta_n^i}$.
  Thus, $D \subseteq E$. Given that both are fields, such a subset relation means that $D \hookrightarrow E$ is a field extension.
  In the notation of field extension degrees, $[E:D] \geq 1$.

  The latter part of the proof requires some Galois Theory \#\#\# CITATION to some textbook? \#\#\#.
  Complex conjugation is a field automorphism of $F$, with $E$ being precisely the fixed subfield.
  By Artin's Lemma, this means that $E \hookrightarrow F$ is a (Galois, in fact) extension.
  We note that by assumption, $E \subseteq F$. Furthermore, $\zeta_n \in F$, but $\zeta_n \notin E$,
  so this extension is non-trivial, which means $[F:E] \geq 2$.

  Now consider the polynomial $f(x) = x^2 - (\zeta_n + \overline{\zeta_n})x + 1$. We constructed this
  polynomial, so that $f(\zeta_n) = 0$, since $\zeta_n \cdot \overline{\zeta_n} = 1$. This means
  that $F$ is a quadratic extension over $D$, which gives $[F:D] = 2$. To finish, we utilise the Tower Law
  applied to the extensions $D \hookrightarrow E, E \hookrightarrow F$:
  \[2 = [F:D] = [F:E] \cdot [E:D] \geq 2 \cdot 1 = 2.\]
  Thus, the two degree inequalities must hold with equality, that is $[F:E] = 2, [E:D] = 1$.
  But $[E:D] = 1$ means that $E = D$, as claimed.
\end{proof}

We shall return to this fact later. Now let $G$ be generated by $g_1, \ldots, g_m$, and let $M_1 = \rho(g_1), \ldots, M_m = \rho(g_m)$.
We note these matrices $M_1, \ldots, M_m \in GL_d(F)$. To find a representation that is isomorphic to
$\rho$ and real, we would need \textit{these} matrices to be real by a change of basis matrix $Q$ (c.f. \cref{def:rep_iso}).
More explicitly, we want a $Q \in GL_d(F)$, such that $\forall i: QM_iQ^{-1} \in GL_d(E)$.

In his paper, Dr. Pasechnik states and proves theorems how to obtain such matrix $Q$.
Here we will only mention the statements of those and prove some of the omitted details. For full proofs, refer to \cite[Lemma 3.1, 3.2]{Pas21}.
\begin{lemma}
  Let $\mathbf{\Sigma} = \sum_{h \in \rho(G)} h^T\overline{h}$. Then this $\mathbf{\Sigma}$ is a Hermitian,
  positive definite, and $\rho(G)$-invariant form, in the sense that
  $\forall g \in \rho(G): g^T\mathbf{\Sigma}\overline{g} = \mathbf{\Sigma}$.
\end{lemma}
\begin{proof}
  We have three claims to prove and we will do so one by one:
  \begin{itemize}
    \item $\mathbf{\Sigma}$ is Hermitian. That is to say, it is a matrix, such that its conjugate
    transpose is itself. In symbols, we want $\mathbf{\Sigma} = \overline{\mathbf{\Sigma}}^T = \mathbf{\Sigma}^*$.
    By design, both conjugation and transposition distribute over a sum. To see what the operation
    does to individual terms, note:
    \[\left(h^T\overline{h}\right)^* = \overline{\left(h^T\overline{h}\right)}^T =
    \left(\overline{h}^Th\right)^T = h^T\left(\overline{h}^{T^T}\right) = h^T\overline{h},\]
    as required. Hence, $\mathbf{\Sigma} = \mathbf{\Sigma}^*$ truly holds.
    \item $\mathbf{\Sigma}$ is positive definite. For this, we have to show that for any row vector $v \in F^d$
    we have $v\mathbf{\Sigma}v^* \geq 0$. So fix any $v$ and note that pre- and post-multiplying by
    a vector is a linear operation, so we have $v\mathbf{\Sigma}v^* = \sum_{h \in \rho(G)} vh^T\overline{h}v^*$.
    Also note that $\overline{h} = h^{T^*}$, from which $\overline{h}v^* = h^{T^*}v^* = \left(vh^T\right)^*$. Therefore:
    \[v\mathbf{\Sigma}v^* = \sum_{h \in \rho(G)} \left(vh^T\right)\left(vh^T\right)^* = \sum_{h \in \rho(G)} \left\lVert vh^T\right\rVert \geq 0,\]
    because each of those complex norms is non-negative.
    \item $\mathbf{\Sigma}$ is $\rho(G)$-invariant. Fix a $g \in \rho(G)$ and start from the mentioned claim:
    \[g^T\mathbf{\Sigma}\overline{g} = g^T\sum_{h \in \rho(G)}h^T\overline{h} \overline{g} = \sum_{h \in \rho(G)}g^Th^T\overline{h} \overline{g}=
    \sum_{h \in \rho(G)} \left(hg\right)^T \overline{(hg)} \color{red}=\color{black} \sum_{k \in \rho(G)} k^T \overline{k} = \mathbf{\Sigma}.\]
    The red equality follows from the fact that both $g,h$ are group elements and that the Cayley tables are latin squares, so
    summing over $h$ of the expression $hg$ is the same as just summing over the group elements $k$.
  \end{itemize}
\end{proof}

Let $\mathbf{M}$ be a non-zero matrix of a $\rho(G)$-invariant form. \#\#\# It is meant to be this, not $G$-invariant, right? \#\#\#
In fact, for real-realisable representations, such a matrix is symmetric. It is also unique, up to scaling.
We postpone the explanation how to obtain this matrix $\mathbf{M}$ until \cref{sec:improve}.

Given these two matrices, he proves in his paper that setting $P = \mathbf{\Sigma}^{-1}\mathbf{M} \in GL_d(F)$
gives $P$ the ``invariance'' property $P\rho(g) = \overline{\rho(g)}P$ for all $g \in G$. Furthermore, $P\overline{P} = \mu I$,
for some $0 < \mu \in E$. Let $x\in F$ be such that $x\overline{x} = \mu$. We want this, because we need
to have $P\overline{P} = I$, so scaling $P$ by dividing it by $x$ gives us what we want (and, of course,
the ``invariance'' property is preserved under scaling).

To obtain such an $x$, we must solve the equation $x\overline{x} = \mu$, so called ``norm equation''.
For this, we use the software PARI/GP \#\#\# citation/reference \#\#\#. Details of using PARI/GP and
communicating with it from within GAP are in the \cref{sec:pari}. If $d$ is odd, then
there is neat trick to skip needing to solve the norm equation, c.f. \cite[Lemma 3.4]{Pas21}.

With $P$ scaled \cite[Lemma 3.3]{Pas21} gives that $Y = \xi P$ and $Q = \overline{Y} + \overline{P}Y = \overline{\xi P} + \xi I$
gives us the desired result of basis change, such that $QM_iQ^{-1} \in GL_d(E)$, provided
that $\xi \neq 0$ and $-\xi/\overline{\xi}$ is \textit{not} an eigenvalue of $P$.
This $\xi$ can be picked randomly from $F$, or we can use the following observation:
\begin{lemma}
  Given that $n$ is the exponent of the group $G$, let $c = 4$ if $4|n$, otherwise let $c$ be
  the smallest odd prime diviving $n$. Then for at least one $a \in \{1,2,\ldots,d+1\}$, we have
  that $-\xi/\overline{\xi}$ is indeed \textbf{not} an eigenvalue of $P$.
\end{lemma}
\begin{proof}
  Note that there are at most $d$ different eigenvalues of $P$. Let $\xi_a = a + \zeta_c, \xi_b = b + \zeta_c$.
  Now assume $-\xi_a/\overline{\xi_a} = -\xi_b/\overline{\xi_b}$. Then we manipulate the equation:
  \begin{align*}
    \frac{-\xi_a}{\overline{\xi_a}} = \frac{-\xi_b}{\overline{\xi_b}}
    & \Leftrightarrow \frac{-a - \zeta_c}{\overline{a + \zeta_c}} = \frac{-b - \zeta_c}{\overline{b + \zeta_c}} \\
    & \Leftrightarrow (a + \zeta_c)(b + \overline{\zeta_c}) = (b + \zeta_c)(a + \overline{\zeta_c}) \\
    & \Leftrightarrow ab + a\overline{\zeta_c}+b\zeta_c + \zeta_c\overline{\zeta_c} = ab + b\overline{\zeta_c}+a\zeta_c + \zeta_c\overline{\zeta_c} \\
    & \Leftrightarrow a\overline{\zeta_c} + b\zeta_c - b\overline{\zeta_c} - a\zeta_c = 0 \\
    & \Leftrightarrow (a - b)(\overline{\zeta_c} - \zeta_c) = 0
  \end{align*}
  From first to the second line, we used that $a,b\in\mathbb{N}$, from which $\overline{a + \zeta_c} = a + \overline{\zeta_c}$.
  In the end, we have two choices; either $\overline{\zeta_c} = \zeta_c$, which is impossible, as $c \geq 3$ by assumption.
  The only other possibility is that $a=b$. To finish the argument, we notice that we have $d+1$ values to pick from,
  but only at most $d$ eigenvalues. Thus, at least one is \textit{not} an eigenvalue.
\end{proof}

\subsection{Norm equation and PARI/GP} \label{sec:pari}

\subsection{Speed improvements and simplifications} \label{sec:improve}

E.g. Kronecker trick on $P$ directly.

\section{Further comments}

In case there are some other bits that need mentioning. Possibly some code-appendix.

\newpage

\printbibliography[title={References}]

\end{document}